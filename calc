Sub calc()
'
' calc Macro
'

Dim i As Integer
Dim j As Integer
Dim k As Integer
Dim l As Integer

Dim cars As Integer
Dim tate As Integer, yoko As Integer
Dim segments As Integer, raw_routes As Integer
Dim kappa As Double, lamb As Double
Dim element As Integer
Dim pass As Range

cars = Range("W2")
tate = Range("W3")
yoko = Range("W4")
kappa = Range("W6")
lambda = Range("W7")

segments = Range("W10")
raw_routes = Range("W11")

For i = 0 To cars - 1
cnt = 0
    For j = 0 To raw_routes - 1
        Set pass = Range(Cells(13 + j, 11), Cells(13 + j, 11 + segments)).Find(What:=Cells(14 + i, 24))
'        Set pass = Range(Cells(13 + j, 11), Cells(13 + j, 11 + segments)).Find(What:=Range(Cells(14 + i, 24), Cells(14 + i, 22 + segments)))
        If Not pass Is Nothing Then
            cnt = cnt + 1
        End If
    Next j
    Cells(14 + i, 23 + segments).Value = cnt
Next i


'
End Sub
